{
  "variables": {
    "api_token": "{{env `DIGITALOCEAN_API_TOKEN`}}",
    "user_passwd": "{{env `RECKEROPS_USER_PASSWD`}}"
  },
  "builders": [{
    "type": "digitalocean",
    "ssh_username": "root",
    "api_token": "{{user `api_token`}}",
    "size": "512mb",
    "region": "ams3",
    "image": "debian-8-x64",
    "droplet_name": "rochester-{{timestamp}}-builder",
    "snapshot_name": "rochester-{{timestamp}}"
  }],
  "provisioners": [{
    "type": "shell",
    "inline": [
      "apt-get update && apt-get dist-upgrade -y",
      "apt-get install -y python-pip && pip install --upgrade pip"
    ]
  },{
    "type": "salt-masterless",
    "local_state_tree": "."
  },{
    "type": "shell",
    "inline": [
      "apt-get remove -y salt-minion salt-common",
      "rm /etc/apt/sources.list.d/saltstack.list",
      "apt-get update"
    ]
  },{
    "type": "shell",
    "inline": [
      "echo \"alex:{{user `user_passwd`}}\" | chpasswd"
    ]
  }]
}
