require 'serverspec'

set :backend, :exec

SSH_KEYS = [
  'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQD/J98LsMpGwuNA/U3jpqOB0YcD8TNO5CSYZmFm7liDWT2Ndw6uOt3wEQx7LcYh1aDeI6XsHkqNSUoMbgVmFQ10KzEWTd/F+JIE/2aQ5uowJ5/DynobXEgAt/c7FqlnCWWK4u4MbAc5oFLn2sc/eeg1FbQP8EnYJ+8Qi0T/ny9gSLHun8oSAI2Ae74iKnPYyEqozZZf46LToR30W3C/6w0kN6k7H9M3IgrZxWuvRZTsQIvl8meo0YxItTR7HDiqSMav5ZXah6mT7OHhCTN0LIReOPsQu2j4Dc96cfWaIfoSTwQtsx/Teoc/BjhNfawj+YwjRk6li36QUw8xjtGauCLivqrDiB2omFrqY3X15JgMQQkSxiRO4TMFjJSKX52vh9YR5P62uuYyZMqzBvn7QfWG4qQWkPkivX3f3TpIGwmF68Adyaz1+bkFnFRcgytGM960w7RVUp2s98ndoqeRK2av6UJvutqXvPyCbKJvHKUIjQ3UivwwienSTuTXDUYT3hjruz1umwMAcRqqadHaNOBViPT7dvg5t+ruCeJedjtdhXRvsiKiFucq8fxzev46jMD/zCq4hlQUV5Uk8cYYT8dius3TojUddgaEV3by29B5h4/6sVjC/MVCIHu4r+qup2a4X9PL+lrVDQyjD0tdHfBI86FBwUV/EuiFxzrvaCGJQw== alex@lappy-486',
  'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDBNbTnoGsJ27oB1U+6BQnkZEmBggKItCsMyCEJV7oaSoKvskWdgmJddcPF+ANWSDhYuku1C2CgCHC+sJFLDvlL3Uj2bfZPmojavWT2AXqiYAKMsTKHMG6z7lFJEwIvUg7RoMKs2dqHXdvzHy6U1SYSl6fsoWNpJzIRySRJoBh9Yud8gejgLof1M2nyG745mSoNBDp3lv3Zhz38q6XW3LGk8djPRM7BACraKMS2Vas/3+T3w4zfjJCLR0WgIg6NYNoCw+0MWizohAbMM80F8pCqGQDDx1n1grkaHfMZ30IRnHOH7ktuJKWtzDKknJIouLX4N2FqhJkQaXqw0kqkD+P5UIJTjP/0+94ONuQY76ZvnQu3WXtw8GC9cCFrbpB39J5YwxIlMTrbFWuZF4quAm7h0Rd35osrNcMkrS06Vw04b0G984SmHGNhIFhMVz+YafXiVZ20QR3+sixy0DSVQgJsHyUDfQ/XqfiG5LZM9CHLTe3+tRkKLNXKce20ZtSjpOdcrXjjUUb9PwN1ZZaV5JunY99ee8+0UPfD8Qit/JS8wVeZdnSDjFxCPTe9TLzNgrTFhwEOYp1IAYj0R8FY8Ex1cm7kuA1O7bS6bpfjKYH+C9WX+i7aOHQzEu/ECwPbgvqXon5C7iyI03hge8Fs0s6OO1VxLH8pD9asC06t2HCLyw== arecker@zendesk.com'
].freeze

describe user('alex') do
  it { should belong_to_group('sudo') }
  it { should have_home_directory('/home/alex') }
  it { should have_login_shell('/bin/bash') }
  SSH_KEYS.each do |key|
    it { should have_authorized_key key }
  end
end
